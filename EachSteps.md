
# 各ステップの役割解説

このドキュメントでは、機能開発の各ステップ（ルーティング、モデル、ビュー、コントローラー）が、それぞれどのような役割を担っているかを解説します。

このプロジェクトでは、それぞれのプログラムが持つ役割を明確に分ける「関心の分離」という考え方を採用しており、これは MVC (Model-View-Controller) という設計思想に基づいています。

---

## Step 1: ルーティングの定義 (交通整理役)

一言でいうと、**Webサイトの「住所録」や「地図」を作る作業**のことです。

ユーザーがブラウザでURLにアクセスすると、Webサーバーにリクエストが送られます。「ルーティングの定義」とは、そのリクエストが**「どのURLへの」「どのような種類のリクエスト」**なのかを判断し、**「どのプログラム（コントローラー）に処理を任せるか」**を紐づける対応表を作成する作業です。

このプロジェクトでは `src/router.ts` がその役割を担います。

#### なぜ最初のステップなのか？
Webアプリケーションは、ユーザーからのリクエストを受け取ることからすべての仕事が始まります。建築で例えるなら、ルーティングは**「玄関」の場所と設計を決める作業**です。最初に玄関がなければ、誰も家の中（アプリケーションの各機能）に入ることができません。そのため、機能追加の際は、まずその機能への入り口を作ることから始めます。

---

## Step 2: モデルの実装 (金庫番と設計図)

一言でいうと、**アプリケーションが扱う「データ」そのものに関するすべてを管理する専門家**です。モデルには、大きく分けて2つの役割があります。

このプロジェクトでは `src/models` ディレクトリのファイル群がその役割を担います。

#### 1. データの構造定義とビジネスロジック (`knowledge.model.ts`)
こちらは「**データの設計図**」にあたる部分です。
-   「ナレッジ」というデータが、どのような項目（`knowledgeId` や `content` など）で構成されるべきかを定義します。
-   `Knowledge.create()` のように、「ナレッジはこうやって作る」「ナレッジを更新するとは、`updatedAt` の日時を更新することである」といった、**データに関する本質的なルール（ビジネスロジック）**を記述します。

#### 2. データの永続化 (`knowledge.repository.ts`)
こちらは「**金庫番**」や「倉庫係」にあたる部分です。
-   コントローラーからの「このデータを保存して」「あのデータを取ってきて」という依頼を受け、実際にストレージ（このプロジェクトではJSONファイル）への**読み書き**を行います。
-   このファイルは、あくまでデータの出し入れの「方法」を知っているだけであり、「なぜ」そのデータが必要なのかというビジネス上の理由は知りません。

---

## Step 3: Viewの実装 (見た目の設計図)

一言でいうと、**ユーザーの目に直接見える Webページの「見た目」そのものを作る作業**のことです。

建築の例えで言うならば、**部屋の内装をデザインし、家具を配置する**作業にあたります。コントローラーから渡されたデータを、ユーザーにとって見やすく、分かりやすく、使いやすい形に整形して表示する責任を持ちます。

このプロジェクトでは `src/features` ディレクトリの `.tsx` ファイルがその役割を担います。

#### Viewの仕事
-   HTMLタグでページの骨格を作る。
-   CSSクラスで見た目を装飾する。
-   コントローラーから渡されたデータを適切な場所に表示する。
-   ユーザーが操作するためのボタンやフォームを配置する。

---

## Step 4: コントローラーの実装 (司令塔)

一言でいうと、**アプリケーションの「司令塔」や「頭脳」を作る作業**のことです。

コントローラーは、Routerから指示を受け取り、専門家である Model と View に具体的な仕事を依頼し、全体の流れを管理するプロジェクトマネージャーのような役割を担います。

このプロジェクトでは `src/controllers` ディレクトリのファイルがその役割を担います。

#### コントローラーの仕事
1.  **指示の受け取り**: Routerから、処理すべき情報を受け取ります。
2.  **データ処理を依頼**: 指示に応じて、Modelにデータの読み書きを依頼します。
3.  **ビジネスロジックの実行**: 「このユーザーにこの操作をする権限はあるか？」といった、アプリケーション固有のルールに基づいた判断を下します。
4.  **表示を指示**: Modelから受け取ったデータをViewに渡し、最終的な画面表示を指示します。

## まとめ

機能開発は、以下の流れで連携して行われます。

**リクエスト** → **Router** (交通整理) → **Controller** (司令塔) → **Model** (データ担当)
                                                    ↑                  ↓
                                                **View** (見た目担当) ← **Controller** (司令塔)

このように各ステップで役割をきれいに分けることで、コードが整理され、変更に強く、見通しの良いアプリケーション構造が実現されています。
